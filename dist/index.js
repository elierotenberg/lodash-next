"use strict";

require("6to5/polyfill");var Promise = require("bluebird");var __DEV__ = (process.env.NODE_ENV !== "production");
var should = require("should");
var _ = require("lodash");
var co = require("co");
var sha256 = require("sha256");
var jsonpatch = require("fast-json-patch");


_.mixin({
  __DEV__: __DEV__,

  should: should,

  scope: function (fn, ctx) {
    return function () {
      fn.apply(ctx, arguments);
    };
  },

  scopeAll: function (ctx, methods) {
    methods.each(function (method) {
      return ctx[method] = _.scope(ctx[method], ctx);
    });
  },

  abstract: function () {
    throw new Error("This method is abstract and should be extended.");
  },

  dev: function (fn) {
    return __DEV__ ? fn() : void 0;
  },

  prod: function (fn) {
    return __DEV__ ? void 0 : fn();
  },

  isServer: function () {
    return typeof window === "undefined";
  },

  isClient: function () {
    return !_.isServer();
  },

  Promise: Promise,

  co: co,

  copromise: function (gen, ctx) {
    ctx = ctx || this;
    return new Promise(function (resolve, reject) {
      return co(gen).call(ctx, function (err, res) {
        return err ? reject(err) : resolve(res);
      });
    });
  },

  deco: function (gen, done, ctx) {
    ctx = ctx || this;
    _.co(gen).call(ctx, done);
  },

  sha256: sha256,

  /* jshint ignore:start */
  adler32: function (data) {
    var a = 1;
    var b = 0;
    var MOD = 65521;
    for (var i = 0; i < data.length; i++) {
      a = (a + data.charCodeAt(i)) % MOD;
      b = (b + a) % MOD;
    }
    return a | (b << 16);
  },
  /* jshint ignore:end */

  hash: function (data) {
    if (_.isObject(data)) {
      return _.hash(JSON.stringify(data));
    }
    return _.adler32(data);
  },

  secureHash: function (data) {
    if (_.isObject(data)) {
      return _.secureHash(JSON.stringify(data));
    }
    return _.sha256(data);
  },

  diff: function (prev, next) {
    return jsonpatch.compare(prev, next);
  },

  patch: function (prev, diff) {
    return jsonpatch.apply(prev, diff);
  },

  base64Encode: function (s) {
    return new Buffer(s).toString("base64");
  },

  base64Decode: function (s) {
    return new Buffer(s, "base64").toString("utf-8");
  },

  guid: function (prefix) {
    var s4 = function () {
      return Math.floor((1 + Math.random()) * 65536).toString(16).substring(1);
    };
    prefix = prefix || "";
    return "" + prefix + "" + s4() + "" + s4() + "-" + s4() + "-" + s4() + "-" + s4() + "-" + s4() + "" + s4() + "" + s4();
  },

  breakpoint: function () {
    /*jshint ignore:start*/
    debugger;
    /*jshint ignore:end*/
  },

  rethrow: function (err, desc) {
    if (err) {
      if (desc) {
        err = _.extendError(err, desc);
      }
      throw err;
    }
  },

  extendError: function (err, desc) {
    err.message = "" + desc + ": " + err.message;
    return err;
  },

  record: function (key, val) {
    return (function (_ref) {
      _ref[key] = val;
      return _ref;
    })({});
  },

  sleep: function (delay) {
    return Promise.delay(delay);
  },

  prollyparse: function (json) {
    try {
      return JSON.parse(json);
    } catch (err) {
      return json;
    }
  },

  prollystringify: function (obj) {
    try {
      return JSON.stringify(obj);
    } catch (err) {
      return obj;
    }
  } });

module.exports = _;
//# sourceMappingURL=data:application/json;base64,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LEdBQUcsQ0FBQyxPQUFPLEFBQUUsQ0FBQztBQUN4QyxXQUFPLEdBQUcsQ0FBQztHQUNaOztBQUVELFFBQU0sRUFBQSxVQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUU7QUFDZjtXQUFVLEdBQUcsSUFBRyxHQUFHOztPQUFaLEVBQWMsRUFBQztHQUN2Qjs7QUFFRCxPQUFLLEVBQUEsVUFBQyxLQUFLLEVBQUU7QUFDWCxXQUFPLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7R0FDN0I7O0FBRUQsYUFBVyxFQUFBLFVBQUMsSUFBSSxFQUFFO0FBQ2hCLFFBQUk7QUFBRSxhQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7S0FBRSxDQUNoQyxPQUFNLEdBQUcsRUFBRTtBQUFFLGFBQU8sSUFBSSxDQUFDO0tBQUU7R0FDNUI7O0FBRUQsaUJBQWUsRUFBQSxVQUFDLEdBQUcsRUFBRTtBQUNuQixRQUFJO0FBQUUsYUFBTyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQUUsQ0FDbkMsT0FBTSxHQUFHLEVBQUU7QUFBRSxhQUFPLEdBQUcsQ0FBQztLQUFFO0dBQzNCLEVBRUYsQ0FBQyxDQUFDOztBQUVILE1BQU0sQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hvdWxkID0gcmVxdWlyZSgnc2hvdWxkJyk7XG5jb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XG5jb25zdCBjbyA9IHJlcXVpcmUoJ2NvJyk7XG5jb25zdCBzaGEyNTYgPSByZXF1aXJlKCdzaGEyNTYnKTtcbmNvbnN0IGpzb25wYXRjaCA9IHJlcXVpcmUoJ2Zhc3QtanNvbi1wYXRjaCcpO1xuXG5cbl8ubWl4aW4oe1xuXG4gIF9fREVWX18sXG5cbiAgc2hvdWxkLFxuXG4gIHNjb3BlKGZuLCBjdHgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBmbi5hcHBseShjdHgsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSxcblxuICBzY29wZUFsbChjdHgsIG1ldGhvZHMpIHtcbiAgICBtZXRob2RzLmVhY2goKG1ldGhvZCkgPT4gY3R4W21ldGhvZF0gPSBfLnNjb3BlKGN0eFttZXRob2RdLCBjdHgpKTtcbiAgfSxcblxuICBhYnN0cmFjdCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIGlzIGFic3RyYWN0IGFuZCBzaG91bGQgYmUgZXh0ZW5kZWQuJyk7XG4gIH0sXG5cbiAgZGV2KGZuKSB7XG4gICAgcmV0dXJuIF9fREVWX18gPyBmbigpIDogdm9pZCAwO1xuICB9LFxuXG4gIHByb2QoZm4pIHtcbiAgICByZXR1cm4gX19ERVZfXyA/IHZvaWQgMCA6IGZuKCk7XG4gIH0sXG5cbiAgaXNTZXJ2ZXIoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnO1xuICB9LFxuXG4gIGlzQ2xpZW50KCkge1xuICAgIHJldHVybiAhXy5pc1NlcnZlcigpO1xuICB9LFxuXG4gIFByb21pc2U6IFByb21pc2UsXG5cbiAgY286IGNvLFxuXG4gIGNvcHJvbWlzZShnZW4sIGN0eCkge1xuICAgIGN0eCA9IGN0eCB8fCB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PlxuICAgICAgY28oZ2VuKS5jYWxsKGN0eCwgKGVyciwgcmVzKSA9PiBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUocmVzKSlcbiAgICApO1xuICB9LFxuXG4gIGRlY28oZ2VuLCBkb25lLCBjdHgpIHtcbiAgICBjdHggPSBjdHggfHwgdGhpcztcbiAgICBfLmNvKGdlbikuY2FsbChjdHgsIGRvbmUpO1xuICB9LFxuXG4gIHNoYTI1Njogc2hhMjU2LFxuXG4gIC8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbiAgYWRsZXIzMihkYXRhKSB7XG4gICAgbGV0IGEgPSAxO1xuICAgIGxldCBiID0gMDtcbiAgICB2YXIgTU9EID0gNjU1MjE7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBhID0gKGEgKyBkYXRhLmNoYXJDb2RlQXQoaSkpICUgTU9EO1xuICAgICAgYiA9IChiICsgYSkgJSBNT0Q7XG4gICAgfVxuICAgIHJldHVybiBhIHwgKGIgPDwgMTYpO1xuICB9LFxuICAvKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuXG4gIGhhc2goZGF0YSkge1xuICAgIGlmKF8uaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIHJldHVybiBfLmhhc2goSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cbiAgICByZXR1cm4gXy5hZGxlcjMyKGRhdGEpO1xuICB9LFxuXG4gIHNlY3VyZUhhc2goZGF0YSkge1xuICAgIGlmKF8uaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIHJldHVybiBfLnNlY3VyZUhhc2goSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cbiAgICByZXR1cm4gXy5zaGEyNTYoZGF0YSk7XG4gIH0sXG5cbiAgZGlmZihwcmV2LCBuZXh0KSB7XG4gICAgcmV0dXJuIGpzb25wYXRjaC5jb21wYXJlKHByZXYsIG5leHQpO1xuICB9LFxuXG4gIHBhdGNoKHByZXYsIGRpZmYpIHtcbiAgICByZXR1cm4ganNvbnBhdGNoLmFwcGx5KHByZXYsIGRpZmYpO1xuICB9LFxuXG4gIGJhc2U2NEVuY29kZShzKSB7XG4gICAgcmV0dXJuIG5ldyBCdWZmZXIocykudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB9LFxuXG4gIGJhc2U2NERlY29kZShzKSB7XG4gICAgcmV0dXJuIG5ldyBCdWZmZXIocywgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGYtOCcpO1xuICB9LFxuXG4gIGd1aWQocHJlZml4KSB7XG4gICAgdmFyIHM0ID0gKCkgPT4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAudG9TdHJpbmcoMTYpXG4gICAgLnN1YnN0cmluZygxKTtcbiAgICBwcmVmaXggPSBwcmVmaXggfHwgJyc7XG4gICAgcmV0dXJuIGAke3ByZWZpeH0ke3M0KCl9JHtzNCgpfS0ke3M0KCl9LSR7czQoKX0tJHtzNCgpfS0ke3M0KCl9JHtzNCgpfSR7czQoKX1gO1xuICB9LFxuXG4gIGJyZWFrcG9pbnQoKSB7XG4gICAgLypqc2hpbnQgaWdub3JlOnN0YXJ0Ki9cbiAgICBkZWJ1Z2dlcjtcbiAgICAvKmpzaGludCBpZ25vcmU6ZW5kKi9cbiAgfSxcblxuICByZXRocm93KGVyciwgZGVzYykge1xuICAgIGlmKGVycikge1xuICAgICAgaWYoZGVzYykge1xuICAgICAgICBlcnIgPSBfLmV4dGVuZEVycm9yKGVyciwgZGVzYyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9LFxuXG4gIGV4dGVuZEVycm9yKGVyciwgZGVzYykge1xuICAgIGVyci5tZXNzYWdlID0gYCR7ZGVzY306ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICByZXR1cm4gZXJyO1xuICB9LFxuXG4gIHJlY29yZChrZXksIHZhbCkge1xuICAgIHJldHVybiB7IFtrZXldOiB2YWwgfTtcbiAgfSxcblxuICBzbGVlcChkZWxheSkge1xuICAgIHJldHVybiBQcm9taXNlLmRlbGF5KGRlbGF5KTtcbiAgfSxcblxuICBwcm9sbHlwYXJzZShqc29uKSB7XG4gICAgdHJ5IHsgcmV0dXJuIEpTT04ucGFyc2UoanNvbik7IH1cbiAgICBjYXRjaChlcnIpIHsgcmV0dXJuIGpzb247IH1cbiAgfSxcblxuICBwcm9sbHlzdHJpbmdpZnkob2JqKSB7XG4gICAgdHJ5IHsgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7IH1cbiAgICBjYXRjaChlcnIpIHsgcmV0dXJuIG9iajsgfVxuICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBfO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9